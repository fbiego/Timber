<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timber Web Serial Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'background': '#1c1c28',
                        'surface': '#28293d',
                        'surface-light': '#3e415b',
                        'primary': '#4c6ef5',
                        'primary-hover': '#5c7cfa',
                        'border': '#3e415b',
                        'text-muted': '#8c8d9e',
                        'log-v': '#2eaf9b',
                        'log-d': '#3b82f6',
                        'log-i': '#22c55e',
                        'log-w': '#f59e0b',
                        'log-e': '#ef4444',
                        'log-a': '#a855f7',
                    }
                }
            }
        }
    </script>
    <style>
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1c1c28; }
        ::-webkit-scrollbar-thumb { background: #3e415b; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #4c6ef5; }
        
        .log-grid {
            display: grid;
            grid-template-columns: 140px 100px 1fr;
            align-items: stretch;
        }

        .log-row {
            border-bottom: 1px solid rgba(62, 65, 91, 0.5);
        }
        
        .log-cell {
            padding: 8px 12px;
            display: flex;
            align-items: flex-start;
        }

        .select-none { user-select: none; }
        
        .animate-pop { animation: pop 0.1s ease-out; }
        @keyframes pop {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        html, body { overflow: hidden; height: 100%; font-family: 'Inter', sans-serif; }
        #logContainer { scrollbar-gutter: stable; }
        
        .mode-pill {
            padding: 4px 16px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 700;
            transition: all 0.2s;
        }

        .mode-pill.active {
            background: #3e415b;
            color: #f1f1f4;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .mode-pill.inactive {
            color: #6c6d7e;
        }
        
        .mode-pill.inactive:hover {
            color: #e1e1e6;
        }

        #hexDelayInput::-webkit-inner-spin-button, 
        #hexDelayInput::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }

        /* Modal styling to match screenshot */
        .modal-label {
            font-size: 14px;
            color: #e1e1e6;
            cursor: pointer;
        }
        
        .modal-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #8c8d9e;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
        }
    </style>

<link rel="stylesheet" href="/index.css">
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
  <script type="module" crossorigin src="/assets/index-DhJmr02x.js"></script>
</head>
<body class="bg-background text-[#e1e1e6] h-screen flex flex-col">
    <!-- Header -->
    <header class="h-12 bg-surface border-b border-border px-4 flex items-center justify-between shrink-0 shadow-md z-[60]">
        <div class="flex items-center gap-3">
            <span class="material-icons text-text-muted">grid_view</span>
            <h1 class="text-sm font-bold tracking-tight">Timber Web Serial Console</h1>
        </div>
        <div class="flex items-center gap-4">
            <a href="https://github.com/fbiego/Timber" target="_blank" class="text-text-muted hover:text-white transition-colors">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
            </a>
            <button id="settingsBtn" class="text-text-muted hover:text-white transition-colors">
                <span class="material-icons text-xl">settings</span>
            </button>
        </div>
    </header>

    <!-- Toolbar -->
    <div class="h-12 bg-surface border-b border-border px-4 flex items-center gap-3 shrink-0 overflow-x-auto relative z-50">
        <button id="connectBtn" class="toolbar-btn bg-primary hover:bg-primary-hover text-white shadow-sm active:scale-95">
            Connect
        </button>

        <div class="flex items-center bg-background border border-border rounded h-8 px-3 shrink-0">
            <select id="baudRateSelect" class="bg-transparent border-none text-[11px] font-medium p-0 focus:ring-0 text-[#f1f1f4] cursor-pointer">
            </select>
            <span class="material-icons text-[16px] text-text-muted ml-1">expand_more</span>
        </div>

        <div class="relative shrink-0">
            <button id="filterBtn" class="toolbar-btn bg-surface-light hover:bg-[#4e516b] text-[#e1e1e6] border border-border active:scale-95">
                <span class="material-icons text-[16px]">filter_alt</span>
                Filters
            </button>
            <div id="filterMenu" class="hidden absolute top-10 left-0 w-52 bg-surface border border-border rounded-lg shadow-2xl z-[60] p-2 animate-pop">
                <div class="flex items-center justify-between px-2 py-1.5 mb-2 border-b border-border">
                    <span class="text-[10px] font-bold text-text-muted uppercase tracking-wider flex items-center gap-1">
                        <span class="material-icons text-sm">filter_list</span> Filters
                    </span>
                    <span class="material-icons text-sm text-text-muted">more_horiz</span>
                </div>
                <div id="filterCheckboxes" class="space-y-0.5"></div>
                <div class="flex gap-2 mt-2 pt-2 border-t border-border">
                    <button id="filterAllBtn" class="flex-1 py-1.5 text-[10px] bg-primary hover:bg-primary-hover text-white rounded font-bold">Select All</button>
                    <button id="filterNoneBtn" class="flex-1 py-1.5 text-[10px] bg-surface-light hover:bg-[#4e516b] text-[#e1e1e6] rounded font-bold">Clear All</button>
                </div>
            </div>
        </div>

        <button id="saveBtn" class="toolbar-btn bg-surface-light hover:bg-[#4e516b] text-[#e1e1e6] border border-border shrink-0 active:scale-95">
            <span class="material-icons text-[16px]">save</span>
            Save Logs
        </button>

        <button id="clearBtn" class="toolbar-btn bg-surface-light hover:bg-[#4e516b] text-[#e1e1e6] border border-border shrink-0 active:scale-95">
            <span class="material-icons text-[16px]">clear_all</span>
            Clear
        </button>
    </div>

    <!-- Terminal View -->
    <main class="flex-1 overflow-hidden relative flex flex-col bg-background">
        <div id="logHeader" class="sticky top-0 z-40 log-grid bg-background border-b border-border font-bold text-[11px] uppercase tracking-widest text-text-muted select-none shadow-sm">
            <div id="headerTime" class="log-cell">Time</div>
            <div id="headerLevel" class="log-cell">Level</div>
            <div class="log-cell">Message</div>
        </div>
        <div id="logContainer" class="flex-1 overflow-y-auto font-mono text-[13px] bg-background"></div>
    </main>

    <!-- Footer Command Section -->
    <section class="shrink-0 bg-surface border-t border-border p-5 shadow-[0_-8px_16px_rgba(0,0,0,0.4)] relative z-40">
        <div class="max-w-6xl mx-auto space-y-4">
            <div class="flex flex-wrap items-center gap-6">
                <div class="flex items-center gap-1 bg-background p-1 rounded-lg border border-border">
                    <span class="text-[10px] text-[#6c6d7e] px-3 font-bold uppercase">Send Mode:</span>
                    <button id="modeAsciiBtn" class="mode-pill active">ASCII</button>
                    <button id="modeHexBtn" class="mode-pill inactive">HEX</button>
                </div>

                <!-- ASCII Options -->
                <div id="asciiOptions" class="flex items-center gap-3">
                    <span class="text-[10px] font-bold text-[#6c6d7e] uppercase">Line Ending:</span>
                    <select id="lineEndingSelect" class="bg-background border border-border text-[10px] font-bold rounded py-1.5 pl-3 pr-8 text-[#e1e1e6] focus:ring-0">
                        <option value="">None</option>
                        <option value="\n">LF (\n)</option>
                        <option value="\r">CR (\r)</option>
                        <option value="\r\n">CRLF (\r\n)</option>
                    </select>
                </div>

                <!-- HEX Options -->
                <div id="hexOptions" class="hidden flex items-center gap-5">
                    <div class="flex items-center gap-2">
                        <label class="flex items-center gap-2 cursor-pointer group">
                            <input id="hexDelayCheck" type="checkbox" class="w-4 h-4 bg-transparent border-border text-primary rounded focus:ring-0">
                            <span class="text-[10px] font-bold text-[#6c6d7e] uppercase group-hover:text-white transition-colors">Delay:</span>
                        </label>
                        <div class="flex items-center bg-background border border-border rounded overflow-hidden h-7">
                            <input id="hexDelayInput" type="number" value="100" class="w-14 bg-transparent text-[10px] font-bold px-2 text-[#e1e1e6] focus:ring-0 text-center outline-none">
                            <span class="text-[9px] font-bold text-[#6c6d7e] pr-2 uppercase">ms</span>
                        </div>
                    </div>
                    <label class="flex items-center gap-2 cursor-pointer group">
                        <input id="hexBatchLinesCheck" type="checkbox" class="w-4 h-4 bg-transparent border-border text-primary rounded focus:ring-0">
                        <span class="text-[10px] font-bold text-[#8c8d9e] group-hover:text-white uppercase transition-colors">Send multiple lines individually</span>
                    </label>
                </div>
            </div>

            <div class="flex gap-4">
                <textarea id="commandInput" class="flex-1 bg-background border border-border focus:border-primary rounded-xl p-4 text-[14px] font-mono text-[#e1e1e6] placeholder-[#4c4d5e] resize-none h-32 transition-all focus:ring-0 shadow-inner" placeholder="Type command here..."></textarea>
                <button id="sendBtn" class="px-10 h-32 bg-primary hover:bg-primary-hover text-white rounded-xl font-bold text-sm shadow-xl active:scale-95 transition-all disabled:opacity-20 shrink-0 flex flex-col items-center justify-center gap-2">
                    <span class="material-icons text-2xl">send</span>
                    <span>SEND</span>
                </button>
            </div>
        </div>
    </section>

    <!-- Settings Modal -->
    <div id="settingsModal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-[100] p-4 backdrop-blur-sm">
        <div class="w-full max-w-[520px] bg-[#28293d] border border-[#3e415b] rounded-xl shadow-2xl overflow-hidden flex flex-col animate-pop">
            <div class="px-6 py-4 flex justify-between items-center border-b border-[#3e415b]">
                <h2 class="text-lg font-bold">Preferences</h2>
                <button id="closeSettingsBtn" class="p-1 hover:bg-[#3e415b] rounded-full text-[#8c8d9e] transition-colors">
                    <span class="material-icons">close</span>
                </button>
            </div>
            
            <div class="p-6 space-y-8 max-h-[75vh] overflow-y-auto">
                <!-- General Section -->
                <section>
                    <h3 class="modal-section-title">General</h3>
                    <div class="space-y-4">
                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input id="prefUseSystemTimestamp" type="checkbox" class="w-4 h-4 rounded border-[#3e415b] bg-transparent text-primary focus:ring-0">
                            <span class="modal-label">Use system timestamp if log lacks timestamp</span>
                        </label>
                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input id="prefAutoConnect" type="checkbox" class="w-4 h-4 rounded border-[#3e415b] bg-transparent text-primary focus:ring-0">
                            <span class="modal-label">Auto-connect to last selected device</span>
                        </label>
                    </div>
                </section>

                <!-- Appearance Section -->
                <section>
                    <h3 class="modal-section-title">Appearance</h3>
                    <div class="space-y-6">
                        <div class="flex flex-col gap-3">
                            <label class="flex items-center gap-3 cursor-pointer">
                                <input id="prefAppearanceDefault" type="radio" name="appearanceMode" value="default" class="w-4 h-4 border-[#3e415b] bg-transparent text-primary focus:ring-0">
                                <span class="modal-label">Default Colors</span>
                            </label>
                            <label class="flex items-center gap-3 cursor-pointer">
                                <input id="prefAppearanceCustom" type="radio" name="appearanceMode" value="custom" class="w-4 h-4 border-[#3e415b] bg-transparent text-primary focus:ring-0">
                                <span class="modal-label">Custom Colors</span>
                            </label>
                        </div>

                        <!-- Levels Grid -->
                        <div id="levelSettingsGrid" class="grid grid-cols-[1fr_auto] gap-x-8 gap-y-4 pt-4">
                            <!-- Injected dynamically to match the 2-column list of settings per level -->
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="p-4 bg-[#1c1c28] border-t border-[#3e415b] flex justify-end gap-3">
                <button id="cancelSettingsBtn" class="px-6 py-2 rounded-lg text-sm font-bold text-[#e1e1e6] bg-[#3e415b] hover:bg-[#4e516b] transition-all">Cancel</button>
                <button id="doneSettingsBtn" class="px-8 py-2 rounded-lg text-sm font-bold text-white bg-primary hover:bg-primary-hover shadow-lg transition-all active:scale-95">Save</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="hidden fixed top-4 left-1/2 -translate-x-1/2 z-[110] px-6 py-2 rounded-full text-[12px] font-bold shadow-2xl border backdrop-blur-md transition-all"></div>

</body>
</html>